<?php echo "<?xml version='1.0' encoding='$CHARSET'?>\n"; ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!-- phpwiki source:
$Id: editpage.html,v 1.10 2002-01-16 03:30:14 carstenklapp Exp $
${RCS_IDS}
-->
<meta http-equiv="Content-Type" content="text/html; charset=${CHARSET}" />
<meta name="robots" content="noindex,nofollow" />
<base href="${BASE_URL}" />
<link rel="shortcut icon" href="favicon.ico" />
${CSS}
<title>${WIKI_NAME} - <?php printf(_("Edit: %s"), $SPLIT_PAGE); ?></title>
</head>
<body class="edit" background="themes/MacOSX/bggranular.png">
<div><a class="wikilink" 
        href="${BROWSE}$_("HomePage")"
        ><img src="${LOGO}"
              border="0" alt="${WIKI_NAME}: $_("HomePage")" 
              align="right" /></a></div>
<h1>$_("Edit"): <a href="${BROWSE}${PAGEURL}"  class="wiki">${SPLIT_PAGE}</a></h1>

<?php if (!empty($PREVIEW_CONTENT)) { ?>
  <p><strong>$_("Preview only!  Changes not saved.")</strong></p>
  <div class="wikitext">${PREVIEW_CONTENT}</div>
<?php } ?>

<?php if (!$IS_CURRENT) { ?>
  <p><strong>$_("Warning: You are editing an old revision.")
        $_("Saving this page will overwrite the current version.")</strong></p>
  <hr class="ignore" noshade />
<?php } ?>

<?php /*
 * FIXME: Hack! 
 * The ${ACTION}EditPage URL used for the form action parameter is bogus.
 * This is needed, otherwise the redirect to the real browser
 * page won't work with some browsers. (NS4 and Mozilla 0.97 won't accept
 * a redirect from a page to itself.)
 *
 * <textarea wrap="virtual"> is not valid xhtml but Netscape 4 requires it
 * to wrap long lines.
 *
 */ ?>

<form method="post" action="${ACTION}EditPage" accept-charset="${CHARSET}">
<textarea class="wikiedit"
          name="content"
          rows="${EDIT_AREA_HEIGHT}"
          cols="${EDIT_AREA_WIDTH}"
          wrap="virtual">$FORMVARS[content]</textarea>
<?php
  $SummaryInput = Element('input', 
                          array('type' => 'text',
                                'class' => 'wikitext',
                                'name' => 'summary',
                                'size' => 50,
                                'value' => $FORMVARS['summary']));

  $MinorEditCb = Element('input', 
                         array('type' => 'checkbox',
                               'name' => 'minor_edit',
                               'checked' => (bool) $FORMVARS['minor_edit']));

  $PreviewB = Element('input', 
                      array('type' => 'submit',
                            'class' => 'button',
                            'name' => 'preview',
                            'value' => _("Preview")));
  $SaveB = Element('input', 
                   array('type' => 'submit',
                         'class' => 'button',
                         'value' => _("Save")));

  if ($user->is_authenticated()) {
    $UserMsg = sprintf(_("You are signed in as %s."), LinkWikiWord($USERID));
  } else {
    $SignInB = $ButtonFactory->makeActionButton('login');         
    $UserMsg = sprintf(_("Author will be logged as %s."),
                       QElement('em', $USERID));
    $UserMsg .= $SignInB->asHTML();
    $UserMsg .= Element('br');
    $UserMsg .= QElement('small', '*' . _("backup and reload after signing in"));
  }
?>

<div class="toolbar" style="text-align: center;">
  $_("Summary:") ${SummaryInput}
</div>
<table summary="Toolbar: Page editing options." class="toolbar" width="100%"
       cellpadding="0" cellspacing="0" border="0"><tr valign="baseline">
  <td>
    ${MinorEditCb} $_("This is a minor change.")
  </td>
  <td align="center">
    ${PreviewB} | ${SaveB}
  </td>
  <td align="right">
    ${UserMsg}
  </td>
</tr></table>

<div name="#edit-tips">
<table summary="Toolbar: Editing Tips" border="0" cellpadding="0" cellspacing="0"><tr valign="middle"><td><p style="clear: both; padding: 2ex 0ex 0ex;">You can change the size of the editing area in </td><td><a class="wikiaction" href="${BROWSE}UserPreferences"><img border="0" alt="UserPreferences" src="themes/MacOSX/locale/en/buttons/UserPreferences.png"></a>&nbsp;</td><td> See </td><td><a class="wikiaction" href="${BROWSE}GoodStyle"><img border="0" alt="GoodStyle" src="themes/MacOSX/locale/en/buttons/GoodStyle.png"></a></td><td> tips for editing.</td></tr></table>
</div>

<hr noshade="noshade" />

<div class="wiki-edithelp">
<?plugin IncludePage page=_("TextFormattingRules") section=_("Synopsis") quiet=1?>
</div>

<input type="hidden" name="action" value="save" />
<input type="hidden" name="pagename" value="$FORMVARS[pagename]" />
<input type="hidden" name="editversion" value="$FORMVARS[editversion]" />
<input type="hidden" name="version" value="$FORMVARS[version]" />
</form>

<?php echo $GLOBALS['ErrorManager']->getPostponedErrorsAsHTML(); ?>
</body>
</html>

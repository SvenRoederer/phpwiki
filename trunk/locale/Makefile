# $Id: Makefile,v 1.8 2002-01-13 22:42:37 dairiki Exp $
#
# locale/Makefile
#
# This is a replacement for locale/translate.sh to avoid remaking
# files that don't need to be remade.
#

POT_FILE = po/phpwiki.pot
PO_FILES = # (auto-generated: see below)
MO_FILES = $(patsubst %.po, %/LC_MESSAGES/phpwiki.mo, $(notdir ${PO_FILES}))
PHP_FILES = ${MO_FILES:.mo=.php}

.PHONY: all po mo clean dep

default:
	@echo ${MO_FILES}

all	: po mo
po 	: ${PO_FILES}
mo	: ${MO_FILES} ${PHP_FILES}

${POT_FILE} : # dependencies are auto-generated by 'make dep' , see below
	xgettext -L C++ -k_ -k__printf -k__sprintf -k__vsprintf -o $@ $^

po/%.po : ${POT_FILE}
	test -f $@ || touch $@
	cp -f $@ $@~
	msgmerge -o $@.new $@~ $^ && mv -f $@.new $@

%/LC_MESSAGES/phpwiki.mo : po/%.po
	mkdir -p $*/LC_MESSAGES
	msgfmt -o $@ $<

# Generate .php from .mo rather than .po to maximize
# the probability of agreement between .mo and .php files.
%/LC_MESSAGES/phpwiki.php : %/LC_MESSAGES/phpwiki.mo
	msgunfmt $< | awk -f make-php-trans.awk > $@

clean :
	rm ${POT_FILE} ${MO_FILES} ${PHP_FILES}

dep :
	$(SHELL) update-makefile.sh


# DO NOT DELETE THIS LINE
#
# The remainder of this file is auto-generated
#
# (Run 'make dep' to regenerate this section.)
#
PO_FILES += po/de.po
PO_FILES += po/es.po
PO_FILES += po/nl.po
PO_FILES += po/sv.po
PO_FILES += po/it.po
#
${POT_FILE}: ../lib/ArchiveCleaner.php
${POT_FILE}: ../lib/config.php
${POT_FILE}: ../lib/DbaDatabase.php
${POT_FILE}: ../lib/DbaListSet.php
${POT_FILE}: ../lib/DbaPartition.php
${POT_FILE}: ../lib/diff3.php
${POT_FILE}: ../lib/difflib.php
${POT_FILE}: ../lib/diff.php
${POT_FILE}: ../lib/display.php
${POT_FILE}: ../lib/editpage.php
${POT_FILE}: ../lib/ErrorManager.php
${POT_FILE}: ../lib/FileCache.php
${POT_FILE}: ../lib/FileFinder.php
${POT_FILE}: ../lib/interwiki.php
${POT_FILE}: ../lib/loadsave.php
${POT_FILE}: ../lib/main.php
${POT_FILE}: ../lib/plugin/_BackendInfo.php
${POT_FILE}: ../lib/plugin/BackLinks.php
${POT_FILE}: ../lib/plugin/Calendar.php
${POT_FILE}: ../lib/plugin/FullTextSearch.php
${POT_FILE}: ../lib/plugin/HelloWorld.php
${POT_FILE}: ../lib/plugin/IncludePage.php
${POT_FILE}: ../lib/plugin/LikePages.php
${POT_FILE}: ../lib/plugin/MostPopular.php
${POT_FILE}: ../lib/plugin/PageHistory.php
${POT_FILE}: ../lib/plugin/RecentChanges.php
${POT_FILE}: ../lib/plugin/text2png.php
${POT_FILE}: ../lib/plugin/TitleSearch.php
${POT_FILE}: ../lib/plugin/Toolbar.php
${POT_FILE}: ../lib/plugin/UserPage.php
${POT_FILE}: ../lib/plugin/ViewSource.php
${POT_FILE}: ../lib/plugin/walkabout.php
${POT_FILE}: ../lib/prepend.php
${POT_FILE}: ../lib/removepage.php
${POT_FILE}: ../lib/Request.php
${POT_FILE}: ../lib/RssWriter.php
${POT_FILE}: ../lib/savepage.php
${POT_FILE}: ../lib/stdlib.php
${POT_FILE}: ../lib/Template.php
${POT_FILE}: ../lib/TextSearchQuery.php
${POT_FILE}: ../lib/Toolbar.php
${POT_FILE}: ../lib/transform.php
${POT_FILE}: ../lib/WikiCallback.php
${POT_FILE}: ../lib/WikiDB/backend/cvs.php
${POT_FILE}: ../lib/WikiDB/backend/dbaBase.php
${POT_FILE}: ../lib/WikiDB/backend/dba.php
${POT_FILE}: ../lib/WikiDB/backend/dumb/AllRevisionsIter.php
${POT_FILE}: ../lib/WikiDB/backend/dumb/BackLinkIter.php
${POT_FILE}: ../lib/WikiDB/backend/dumb/MostPopularIter.php
${POT_FILE}: ../lib/WikiDB/backend/dumb/MostRecentIter.php
${POT_FILE}: ../lib/WikiDB/backend/dumb/TextSearchIter.php
${POT_FILE}: ../lib/WikiDB/backend/mysql.php
${POT_FILE}: ../lib/WikiDB/backend/PearDB.php
${POT_FILE}: ../lib/WikiDB/backend/pgsql.php
${POT_FILE}: ../lib/WikiDB/backend.php
${POT_FILE}: ../lib/WikiDB/cvs.php
${POT_FILE}: ../lib/WikiDB/dba.php
${POT_FILE}: ../lib/WikiDB.php
${POT_FILE}: ../lib/WikiDB/SQL.php
${POT_FILE}: ../lib/WikiPlugin.php
${POT_FILE}: ../lib/WikiUser.php
${POT_FILE}: ../lib/ziplib.php
${POT_FILE}: ../templates/browse.html
${POT_FILE}: ../templates/editpage.html
${POT_FILE}: ../templates/message.html
${POT_FILE}: ../themes/default/themeinfo.php
${POT_FILE}: ../themes/Hawaiian/pictures/random.php
${POT_FILE}: ../themes/Hawaiian/themeinfo.php
${POT_FILE}: ../themes/MacOSX/templates/browse.html
${POT_FILE}: ../themes/MacOSX/templates/editpage.html
${POT_FILE}: ../themes/MacOSX/templates/message.html
${POT_FILE}: ../themes/MacOSX/themeinfo.php
${POT_FILE}: ../themes/WikiTrek/themeinfo.php

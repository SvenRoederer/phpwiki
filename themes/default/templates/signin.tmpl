<?php // -*-html-*- ?>
<!-- $Id: signin.tmpl,v 1.10 2002-01-24 00:45:28 dairiki Exp $ -->
<?php

     $Sep = $Theme->getButtonSeparator();
     $SignOutB = $Theme->makeButton(_("Sign Out"), "javascript:SignOut();", 'wikiaction');

     if (empty($FORMNAME))
         $FORMNAME = 'signin';
     else
         $NOFORM = true;
?>

<?php if (empty($NOFORM)) { ?>
  <form method="post" action="<?=BASE_URL?>" accept-charset="<?=CHARSET?>" name="<?=$FORMNAME?>">

  <?php foreach ($request->getArgs() as $key => $val) { ?>
    <input type="hidden" name="<?=$key?>" value="<?=$val?>" />
  <?php } ?>
<?php } ?>

<?php if ($user->isSignedIn()) {  ?>

  <?= fmt("You are signed in as %s", LinkWikiWord($user->getId())) ?>
  <?=$Sep?>
  <script language="JavaScript" type="text/javascript"><!--
    document.write('<input type="hidden" name="auth[logout]" value="0" />');
    function SignOut() { 
      document.forms["<?=$FORMNAME?>"].elements["auth[logout]"].value = 1;
      document.forms["<?=$FORMNAME?>"].submit();
    }
    document.write('<?=$SignOutB?>'); // -->
  </script>
  <noscript>
    <?=$Theme->makeButton(_("Sign Out"), "submit:auth[logout]", "wikiaction")?>
  </noscript>

<?php } else { ?>

  <?php $SignInInput = HTML::input(array('type' => 'text',
                                         'name' => "auth[userid]",
                                         'size' => 12,
                                         'onchange' => "this.form.submit();"));
        $SignInInput->addTooltip(_("Sign In")) ?>

  <script language="JavaScript" type="text/javascript"><!--
    document.write("<small><?=_("Sign In")?></small> ");
  // --></script>
  <?= $SignInInput ?>
  <noscript>
    <?=$Theme->makeButton(_("Sign In"), "submit:auth[login]", "wikiaction")?>
  </noscript>

<?php } ?>

<?php if (empty($NOFORM)) { ?>
  </form>
<?php } ?>

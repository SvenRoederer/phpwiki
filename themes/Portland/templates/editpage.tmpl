<!-- -*-html-*- -->
<!-- $Id: editpage.tmpl,v 1.2 2002-01-20 00:54:11 carstenklapp Exp $ -->
<?php
  $SummaryInput = Element('input', 
                          array('type' => 'text',
                                'class' => 'wikitext',
                                'name' => 'summary',
                                'size' => 50,
                                'value' => $FORMVARS['summary']));

  $MinorEditCb = Element('input', 
                         array('type' => 'checkbox',
                               'name' => 'minor_edit',
                               'checked' => (bool) $FORMVARS['minor_edit']));

  $PreviewB = Element('input', 
                      array('type' => 'submit',
                            'class' => 'button',
                            'name' => 'preview',
                            'value' => _("Preview")));
  $SaveB = Element('input', 
                   array('type' => 'submit',
                         'class' => 'button',
                         'name' => 'save',
                         'value' => _("Save")));


  $SignIn = new WikiTemplate('signin');
  $SignIn->qreplace('FORMNAME', 'editpage');

  $s = $Theme->getButtonSeparator();
?>

<?php /*
 * FIXME: Hack! 
 * The <?=$ACTION?>EditPage URL used for the form action parameter is bogus.
 * This is needed, otherwise the redirect to the real browser
 * page won't work with some browsers. (NS4 and Mozilla 0.97 won't accept
 * a redirect from a page to itself.)
 *
 * <textarea wrap="virtual"> is not valid xhtml but Netscape 4 requires it
 * to wrap long lines.
 *
 */ ?>

<form method="post" action="<?=$ACTION?>EditPage" accept-charset="<?=CHARSET?>" name="editpage">
<table summary="Toolbar: Save, Preview, and edit warnings." class="toolbar" width="100%"
       cellpadding="0" cellspacing="0" border="0"><tr align="baseline">
  <td>
    <?php if (!$IS_CURRENT) { ?>
      <p><strong><?=_("Warning: You are editing an old revision.")?>
            <?=_("Saving this page will overwrite the current version.")?></strong></p>
    <?php } ?>
    <?php if (isset($PREVIEW_CONTENT)) { ?>
      <p><strong><?=_("Preview only!  Changes not saved.")?></strong></p>
    <?php } ?>
  </td>
  <td align="right"><?= $PreviewB ?><?=$s?><?= $SaveB ?></td></tr>
  <?php if (isset($PREVIEW_CONTENT)) { ?>
    <tr><td colspan="2">
      <hr />
      <div class="wikitext"><?= $PREVIEW_CONTENT ?></div>
    </td></tr>
  <?php } ?>
</table>
<textarea class="wikiedit"
          name="content"
          rows="<?=$EDIT_AREA_HEIGHT?>"
          cols="<?=$EDIT_AREA_WIDTH?>"
          wrap="virtual"><?=$FORMVARS['content']?></textarea>

  <?=_("Summary:")?> <?= $SummaryInput ?>
  <br />
  <?php printf(_("Author will be logged as %s."),
               QElement('em', $USERID)); ?>
  <br />
  <?= $MinorEditCb ?>
  <?php printf(_("I'm just doing minor edits. Please divert the usual logging to %s instead."),
               LinkExistingWikiWord(_("RecentEdits"))); ?>
  <br /><br />
<div name="#edit-tips"><?php
  // FIXME: convert this to use the IncludePage plugin.
  printf(_("See %s tips for editing."),
         LinkExistingWikiWord(_("GoodStyle")));
  printf("<br />\n" ._("You can change the size of the editing area in %s."),
         LinkExistingWikiWord(_("UserPreferences")));
?></div>

<div class="wiki-edithelp">
<?plugin IncludePage page=_("TextFormattingRules") section=_("Synopsis") quiet=1?>
</div>
<input type="hidden" name="action" value="save" />
<input type="hidden" name="pagename" value="<?=$FORMVARS['pagename']?>" />
<input type="hidden" name="editversion" value="<?=$FORMVARS['editversion']?>" />
<input type="hidden" name="version" value="<?=$FORMVARS['version']?>" />
</form>
<hr />
